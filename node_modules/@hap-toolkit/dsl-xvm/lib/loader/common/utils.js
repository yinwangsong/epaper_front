"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getNameByPath=getNameByPath,exports.getFileNameWithHash=getFileNameWithHash,exports.isPlainObject=isPlainObject,exports.loadBabelModule=loadBabelModule,exports.makeRequireString=makeRequireString,exports.stringifyLoaders=stringifyLoaders,exports.generateMap=generateMap,exports.consumeMap=consumeMap,exports.splitSourceLine=splitSourceLine,exports.print=print,exports.getWebpackOptions=getWebpackOptions,exports.isUXRender=isUXRender,exports.isUXEntry=isUXEntry,exports.convertPath=convertPath,Object.defineProperty(exports,"colorconsole",{enumerable:!0,get:function(){return _sharedUtils.colorconsole}}),Object.defineProperty(exports,"logWarn",{enumerable:!0,get:function(){return _sharedUtils.logWarn}}),Object.defineProperty(exports,"mkdirsSync",{enumerable:!0,get:function(){return _sharedUtils.mkdirsSync}}),Object.defineProperty(exports,"KnownError",{enumerable:!0,get:function(){return _sharedUtils.KnownError}}),exports.FRAG_TYPE=exports.ENTRY_TYPE=void 0;var _path=_interopRequireDefault(require("path")),_fs=_interopRequireDefault(require("fs")),_loaderUtils=_interopRequireDefault(require("loader-utils")),_hashSum=_interopRequireDefault(require("hash-sum")),_sourceMap=require("source-map"),_config=_interopRequireDefault(require("@hap-toolkit/shared-utils/config")),_sharedUtils=require("@hap-toolkit/shared-utils");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function getNameByPath(e){return _path.default.basename(e).replace(/\..*$/,"")}function getFileNameWithHash(e,t){const r=_path.default.relative(".",e);return`./${r}?${(0,_hashSum.default)(r+t)}`}const toString=Object.prototype.toString,OBJECT_STRING="[object Object]";function isPlainObject(e){return toString.call(e)===OBJECT_STRING}function loadBabelModule(e){const t=_path.default.resolve(__dirname,"..","node_modules",e),r=_path.default.resolve(_config.default.projectPath,"node_modules",e);return _fs.default.existsSync(t)?t:_fs.default.existsSync(r)?r:e}function makeRequireString(e,t,r){return print({loader:t,filepath:r}),"require("+_loaderUtils.default.stringifyRequest(e,t?`!${t}!${r}`:`${r}`)+")\n"}function stringifyLoaders(e){return e.map(e=>{if("string"==typeof e)return e;{const t=e.name,r=[];if(e.query)for(const t in e.query){const n=e.query[t];null!=n&&(!0===n?r.push(t):n instanceof Array?r.push(`${t}[]=${n.join(",")}`):r.push(`${t}=${n}`))}return`${t}${r.length?"?"+r.join("&"):""}`}}).join("!")}function generateMap(e,t,r){const n=getFileNameWithHash(e.resourcePath),o=_path.default.resolve("."),i=new _sourceMap.SourceMapGenerator({sourceRoot:o,skipValidation:!0});i.setSourceContent(n,t);for(const{original:e,generated:t}of r)i.addMapping({source:n,original:e,generated:t});return i}function consumeMap(e,t,r){const n=new _sourceMap.SourceMapConsumer(r);let o;const i=[],s=[],a={};return splitSourceLine(t).forEach((e,t)=>{t+=1;const r=n.originalPositionFor({line:t,column:0});r.source&&(o=r.source,i.push({line:r.line,column:r.column}),s.push({line:t,column:0}),a[`line-${t}-column-0`]={line:r.line,column:r.column})}),{source:o,original:i,generated:s,mapping:a,sourcesContent:n.sourcesContent}}const REGEXP_LINE=/\r?\n/g;function splitSourceLine(e){return e.split(REGEXP_LINE)}const showLog=!1;function print(e){if(showLog){let t="";if("string"==typeof e)t="######### "+e+" #########";else for(const r in e)t+="######### "+r+" : "+e[r]+" #########\n";console.log(t)}}function getWebpackOptions(e){return e.options||{}}function isUXRender(e){return e===ENTRY_TYPE.PAGE||e===ENTRY_TYPE.CARD}function isUXEntry(e){return e===ENTRY_TYPE.PAGE||e===ENTRY_TYPE.APP||e===ENTRY_TYPE.CARD}function convertPath(e){let t=_path.default.join(_config.default.projectPath,"src");return/^[/\\]node_modules/.test(e)&&(t=_config.default.projectPath),_path.default.join(t,e)}const ENTRY_TYPE={APP:"app",PAGE:"page",COMP:"comp",CARD:"card",JS:"js"};exports.ENTRY_TYPE=ENTRY_TYPE;const FRAG_TYPE={IMPORT:"import",TEMPLATE:"template",STYLE:"style",SCRIPT:"script"};exports.FRAG_TYPE=FRAG_TYPE;
//# sourceMappingURL=utils.js.map
