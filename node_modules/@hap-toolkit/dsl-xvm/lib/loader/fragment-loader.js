"use strict";var _loaderUtils=_interopRequireDefault(require("loader-utils")),_compiler=require("@hap-toolkit/compiler"),_utils=require("./common/utils");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}module.exports=function(e,t){this.cacheable&&this.cacheable();const i=this.async(),l=_loaderUtils.default.parseQuery(this.query),n=l.type,r=this.resourcePath;let s=l.index;null!=s&&s.match(/^\d+$/)&&(s=parseInt(s)),Promise.resolve((0,_compiler.parseFragmentsWithCache)(e,r)[n]).then(i=>{null!=s&&(i=i[s]);let l,r=i.content.trim();if(this.sourceMap&&(n===_utils.FRAG_TYPE.SCRIPT||n===_utils.FRAG_TYPE.IMPORT)){const n=i.location.line;let s;t&&(s=(0,_utils.consumeMap)(this,e,t),e=s.sourcesContent.join(""));const o=(0,_utils.splitSourceLine)(r).map((e,t)=>{let i=(t+=1)+n;const l=t;return s&&(i=s.mapping[`line-${i}-column-0`].line),{original:{line:i,column:0},generated:{line:l,column:0}}});l=(0,_utils.generateMap)(this,e,o)}return[r,l]}).then(([e,l])=>{i(null,e,l&&l.toJSON()||t)}).catch(e=>{i(e,"")})};
//# sourceMappingURL=fragment-loader.js.map
