"use strict";var _compiler=require("@vivo-hap-toolkit/compiler");class Css2jsonPlugin{constructor(s){this.options=s}apply(s){s.hooks.emit.tapAsync("Css2jsonPlugin",(s,t)=>{for(const t in s.assets)if(t.match(/css\.json$/)){const o=s.assets[t]._source.children.filter(s=>s._value),e=o.length;o.map((s,o)=>{this.css2Json({code:s._value,filePath:t},t=>{let c="";0===o?(c='{"list":['+t,c+=o===e-1?"]}":","):(c=t,c+=o<e-1?",":"]}"),s._value=c})})}t()}),s.hooks.afterEmit.tapAsync("Css2jsonPlugin",(s,t)=>{for(const t in s.assets)t.match(/css\.json$/)&&(s.assets[t]._source.children=[]);t()})}css2Json(s,t){const o=String(s.code).match(/\[(.*)\]/);let e={};const{parsed:c}=(0,_compiler.parseStyle)(s);let n=c;if(o&&o[1]){e[o[1]]=n}else e=n;t&&t(e)}}module.exports=Css2jsonPlugin;
//# sourceMappingURL=css2json-plugin.js.map
