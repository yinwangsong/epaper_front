"use strict";const path=require("path"),fs=require("fs"),VueLoaderPlugin=require("vue-loader/lib/plugin"),MiniCssExtractPlugin=require("mini-css-extract-plugin"),{colorconsole:colorconsole}=require("@vivo-hap-toolkit/shared-utils"),Css2jsonPlugin=require("./plugin/css2json-plugin"),InstVuePlugin=require("./plugin/instvue-plugin");module.exports.postHook=function(e,{cwd:s},{loaderWrapper:u}){const r=path.resolve(s,"hap.config.js");let l;if(fs.existsSync(r))try{l=require(r)}catch(e){colorconsole.error(`加载webpack配置文件[${r}]出错：${e.message}`)}else l={module:{rules:[{test:/\.css$/,use:[MiniCssExtractPlugin.loader,"css-loader"]},{test:/\.vue$/,use:{loader:require.resolve("vue-loader"),options:{hotReload:!1}}}]},plugins:[new VueLoaderPlugin,new MiniCssExtractPlugin({filename:"[name].css.json"})]};(l&&l.module&&l.module.rules||[]).forEach(s=>{s.test.exec(".vue")&&(u(s),s.use.push({loader:require.resolve("./loader/validator-loader")})),s.test.exec(".ts")&&u(s),e.module.rules.push(s)}),e.plugins.push(...l&&l.plugins||[]),e.plugins.push(new Css2jsonPlugin,new InstVuePlugin)};
//# sourceMappingURL=webpack.post.js.map
